function switchTeamApp()
{
    for($("#create-switch-button").toggleClass("show"),
        $("#update-switch-button").toggleClass("show"),
        title=$("#team-title").text(),
        "Création des équipes"==title?$("#team-title").text("Modification des équipes"):$("#team-title").text("Création des équipes"),
        $("#create-team-button").toggleClass("show"),
        $("#update-team-button").toggleClass("show"),
        $("#delete-team-button").toggleClass("show"),
        $("#project-teams-title").toggleClass("show"),
        $("#project-teams-div").toggleClass("show"),
        $("#teamName").val(""),
        l=freeUsersIds.length,
        i=0;i<l;i++)
            $("#free-user-"+freeUsersIds[i]).hasClass("show")&&$("#adding-user-"+freeUsersIds[i]).removeClass("show"),
            $("#adding-user-"+freeUsersIds[i]).hasClass("show")&&($("#adding-user-"+freeUsersIds[i]).removeClass("show"),
            $("#free-user-"+freeUsersIds[i]).addClass("show"));
    for(l=teamIds.length,i=0;i<l;i++)
        $(".team-members-"+teamIds[i]).hasClass("show")&&$(".team-members-"+teamIds[i]).removeClass("show");
        $("#delete-team-button").attr("href",CONTROLLERS_URL+"admin/detailsProjet.php?action=deleteTeam&idProject="+projectId)
}
        
function toggleUserToTeam(e)
{
    $("#free-user-"+e).toggleClass("show"),
    $("#adding-user-"+e).toggleClass("show")
}


function toggleUserToExistingTeam(e)
{
    $("#freeing-user-"+e).toggleClass("show"),
    $("#adding-again-user-"+e).toggleClass("show")
}

function showTeamMembers(e,t)
{
    $.ajax(
        {
            async:!0,
            url:AJAX_URL+"admin/detailsProjet.php?action=getTeamActive&teamId="+e,
            success:function(t)
            {
                teamActive=t,
                teamActive=teamActive.replace('"',"").replace('"',""),
                teamActive=parseInt(teamActive),
                0==teamActive?($("#archive-team-button").removeClass("show"),
                $("#open-team-button").addClass("show").attr("href",CONTROLLERS_URL+"admin/detailsProjet.php?action=openTeam&teamId="+e+"&idProject="+projectId)):($("#archive-team-button").addClass("show").attr("href",CONTROLLERS_URL+"admin/detailsProjet.php?action=archiveTeam&teamId="+e+"&idProject="+projectId),
                $("#open-team-button").removeClass("show"))
            }
        }),
    $("[id^=freeing-user-]").removeClass("show"),
    $("[id^=adding-again-user-]").removeClass("show"),
    $(".team-members-"+e).addClass("show"),
    $("#team-id-update-input").val(e),
    $("#delete-team-button").addClass("show"),
    $("#delete-team-button").attr("href",CONTROLLERS_URL+"admin/detailsProjet.php?action=deleteTeam&teamId="+e+"&idProject="+projectId),
    $("#map-btn").attr("href",CONTROLLERS_URL+"admin/map.php?projectId="+projectId+"&teamId="+e),
    $("#teamName").val(t),
    teamIds.forEach(e=>{
        elementTeamName=$("#team-sticker-"+e).children().first().text(),
        $("#team-sticker-"+e).off("click").click(function(){
            showTeamMembers(e,elementTeamName)
        })
    })
}

$("#create-switch-button").click(function()
{
    switchTeamApp(),
    $("#archive-team-button").removeClass("show"),
    $("#open-team-button").removeClass("show")
}),

$("#update-switch-button").click(function()
{
    switchTeamApp()
}),

$("#create-team-button").click(function()
{
    $("#teamName-hidden-create").val($("#teamName").val()),
    freeUsersIds.forEach(function(e,t){
        $("#adding-user-"+e).hasClass("show")&&$("#add-team-form").append("<input type='hidden' name='addingUser"+t+"' value='"+e+"'>")
    }),
    $("#add-team-form").submit()
}),

$("#close-alert").click(function()
{
    $(this).parent().removeClass("show alert-visible").css({
            opacity:"0",display:"none"
        })
}),

$("#update-team-button").click(function(){
    $("#teamName-hidden-update").val($("#teamName").val()),
    $("#teamName-hidden-update").val($("#teamName").val()),
    Obj=Project.teams,
    ProjectTeams=[],
    Object.keys(Obj).forEach(e=>ProjectTeams.push({
        rowid:Obj[e].rowid,users:Obj[e].users
    })),
    teamId=$("#team-id-update-input").val(),
    ProjectTeams.forEach(e=>{
        Obj=e.users,
        users=[],
        Object.keys(Obj).forEach(e=>users.push({
            rowid:Obj[e].rowid
        })),
        teamRowid=e.rowid,
        teamId==teamRowid&&(users.forEach(function(e,t){
            userRowid=e.rowid,
            $("#freeing-user-"+userRowid).hasClass("show")&&$("#update-team-form").append("<input type='hidden' name='removingUser"+t+"' value='"+userRowid+"'>")
        }),
        freeUsersIds.forEach(function(e,t){
            $("#free-user-"+e).hasClass("show")||$("#update-team-form").append("<input type='hidden' name='addingUser"+t+"' value='"+e+"'>")
        }))
    }),
    $("#update-team-form").submit()
});